# XStem Navigation System Configuration

services:
  filter:
    name: "filter"
    host: "localhost"
    port: 20001

  track_follower:
    name: "track_follower"
    host: "localhost"
    port: 20101

  canbus:
    name: "canbus"
    host: "localhost"
    port: 6001

  oak0:
    name: "oak/0"
    host: "localhost"
    port: 50010

  oak1:
    name: "oak/1"
    host: "localhost"
    port: 50010

waypoints:
  csv_path: "~/Amiga/amiga-adk/py/examples/waypoint_navigation/surveyed-waypoints/kktcBack2Lanes.csv"
  coordinate_system: "ENU"
  last_row_waypoint_index: 6
  turn_direction: "left"
  row_spacing_m: 6.0
  headland_buffer_m: 2.0

tool:
  type: "stemming"
  offset_x: 0.25
  offset_y: 0.0
  offset_z: 0.0
  dipbob_can_signal: "dipbob_deploy"
  dipbob_ack_timeout_s: 5.0
  chute_actuator_id: 0
  chute_open_duration_s: 0.2
  chute_close_duration_s: 0.3
  chute_rate_hz: 10.0

vision:
  enabled: false
  mode: "stop_to_detect"
  search_radius_m: 1.0
  detection_timeout_s: 10.0
  min_confidence: 0.7

  forward_camera:
    service_name: "oak/1"
    role: "forward"
    model_path: "~/Amiga/xstem/models/best.pt"
    offset_x: 0.55
    offset_y: 0.0
    offset_z: 0.88
    pitch_deg: 30.0

  downward_camera:
    service_name: "oak/0"
    role: "downward"
    model_path: "~/Amiga/xstem/models/best.pt"
    offset_x: 0.25
    offset_y: 0.0
    offset_z: 0.5
    pitch_deg: -90.0

navigation:
  approach_offset_m: 1.2
  error_recovery_max_retries: 3
  filter_convergence_retries: 3
  can_recovery_delay_s: 0.5

thresholds:
  positioning_accuracy_m: 0.05
  heading_accuracy_deg: 10.0
  alignment_tolerance_m: 0.02
